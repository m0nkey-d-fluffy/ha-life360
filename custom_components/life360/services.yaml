update_location:
  name: Update Location
  description: Request a location update for Life360 members. This typically causes the member's location to be updated every 5 seconds for about one minute.
  target:
    entity:
      integration: life360
      domain: device_tracker

sync_places:
  name: Get Life360 Places
  description: Retrieve all Life360 Places and fire a 'life360_places' event with the data. Use this to see your Life360 places and manually create corresponding Home Assistant zones. Returns place names, coordinates, and radius.

sync_geofence_zones:
  name: Get Life360 Geofences
  description: Retrieve all Life360 geofence zones and fire a 'life360_geofences' event with the data. Use this to see your Life360 geofences and manually create corresponding Home Assistant zones. Returns zone names, coordinates, radius, and type.

get_emergency_contacts:
  name: Get Emergency Contacts
  description: Retrieve emergency contacts from all Life360 circles. The contacts are returned as service response data and also fired as a 'life360_emergency_contacts' event.

get_integrations:
  name: Get Connected Integrations
  description: Retrieve all connected integrations/apps from Life360. Returns information about linked services like Tile, Jiobit, etc.

get_devices:
  name: Get Devices and Circles
  description: Retrieve all Tile/Jiobit devices and Life360 circles with their IDs. Use this to find device IDs and circle IDs needed for ring_device and other services. Returns device names, IDs, categories, BLE capabilities, and all circle IDs.

diagnose_tile_ble:
  name: Diagnose Tile BLE Connections
  description: Scan for all Tile devices via Bluetooth and read their actual device IDs to verify MAC address mappings. This diagnostic tool helps troubleshoot BLE connectivity issues by connecting to each Tile and reading its device ID from GATT characteristics. Check your Home Assistant logs for detailed results.

diagnose_ring_all_ble:
  name: Ring All BLE Devices (Brute Force)
  description: "DIAGNOSTIC: Attempts to connect to EVERY BLE device seen by Home Assistant and tries to ring it as a Tile. This brute-force approach helps identify which MAC addresses are actually Tiles. WARNING: This will attempt connections to all nearby BLE devices. Check logs for results and listen for which Tiles ring!"

diagnose_raw_ble_scan:
  name: Raw BLE Scan (Direct)
  description: "DIAGNOSTIC: Performs a direct BLE scan bypassing Home Assistant's Bluetooth backend. Logs ALL advertisement data including service UUIDs, service data, and manufacturer data for every device found. Use this to troubleshoot when HA's Bluetooth backend isn't seeing service UUIDs. Press Tile buttons during scan! Check logs for detailed results."
  fields:
    scan_timeout:
      name: Scan Timeout
      description: How long to scan in seconds
      required: false
      default: 30
      example: 30
      selector:
        number:
          min: 10
          max: 120
          unit_of_measurement: seconds

diagnose_ring_tile_by_mac:
  name: Test Ring Tile by MAC
  description: "DIAGNOSTIC: Directly connects to a Tile at a specific MAC address and attempts to ring it. Uses persistent scanning that stops as soon as the Tile is found. You'll need the MAC address and Tile ID."
  fields:
    mac_address:
      name: MAC Address
      description: The MAC address to connect to (e.g., C3:A7:57:B8:47:9C)
      required: true
      example: "C3:A7:57:B8:47:9C"
      selector:
        text:
    tile_id:
      name: Tile ID
      description: The Tile device ID (from Life360 API)
      required: true
      example: "03a757b8479cbdfc"
      selector:
        text:
    scan_timeout:
      name: Scan Timeout
      description: Maximum seconds to scan for Tile (default 120s, stops early when found)
      required: false
      default: 120
      example: 600
      selector:
        number:
          min: 30
          max: 600
          unit_of_measurement: seconds

diagnose_list_tiles:
  name: List All Tiles
  description: "DIAGNOSTIC: Lists all cached Tile devices with their device IDs, MAC addresses, Tile IDs, and auth key status. Use this to get the information needed for ring tests. Results are shown in logs and a notification."

buzz_jiobit:
  name: Buzz Jiobit Device
  description: Send a buzz command to a Jiobit pet GPS tracker to help locate your pet. The device will emit a sound. You can use either entity_id (easier) or device_id + circle_id (advanced).
  fields:
    entity_id:
      name: Entity
      description: The Jiobit device tracker entity (easiest method - automatically determines device_id and circle_id)
      required: false
      example: "device_tracker.jiobit_fluffy"
      selector:
        entity:
          integration: life360
          domain: device_tracker
    device_id:
      name: Device ID (Advanced)
      description: The Jiobit device ID to buzz (use this OR entity_id)
      required: false
      example: "dr123456"
      selector:
        text:
    circle_id:
      name: Circle ID (Advanced)
      description: The Life360 circle ID the device belongs to (required if using device_id)
      required: false
      example: "abc123-def456"
      selector:
        text:

ring_device:
  name: Ring Device
  description: Ring/buzz a Tile or Jiobit device to help locate it. The device will emit a sound for the specified duration. You can use either entity_id (easier) or device_id + circle_id (advanced).
  fields:
    entity_id:
      name: Entity
      description: The Tile/Jiobit device tracker entity (easiest method - automatically determines device_id, circle_id, and provider)
      required: false
      example: "device_tracker.tile_keys"
      selector:
        entity:
          integration: life360
          domain: device_tracker
    device_id:
      name: Device ID (Advanced)
      description: The device ID to ring (use this OR entity_id)
      required: false
      example: "abc123"
      selector:
        text:
    circle_id:
      name: Circle ID (Advanced)
      description: The Life360 circle ID the device belongs to (required if using device_id)
      required: false
      example: "abc123-def456"
      selector:
        text:
    provider:
      name: Provider
      description: Device provider (tile or jiobit) - auto-detected from entity if using entity_id
      required: false
      example: "tile"
      selector:
        select:
          options:
            - "jiobit"
            - "tile"
    duration:
      name: Duration
      description: How long to ring in seconds (1-300)
      required: false
      default: 30
      example: 30
      selector:
        number:
          min: 1
          max: 300
          unit_of_measurement: seconds
    strength:
      name: Strength
      description: Ring strength/volume (1=low, 2=medium, 3=high)
      required: false
      default: 2
      example: 2
      selector:
        number:
          min: 1
          max: 3

stop_ring_device:
  name: Stop Ringing Device
  description: Stop ringing/buzzing a Tile or Jiobit device. You can use either entity_id (easier) or device_id + circle_id (advanced).
  fields:
    entity_id:
      name: Entity
      description: The Tile/Jiobit device tracker entity (easiest method - automatically determines device_id, circle_id, and provider)
      required: false
      example: "device_tracker.tile_keys"
      selector:
        entity:
          integration: life360
          domain: device_tracker
    device_id:
      name: Device ID (Advanced)
      description: The device ID to stop ringing (use this OR entity_id)
      required: false
      example: "abc123"
      selector:
        text:
    circle_id:
      name: Circle ID (Advanced)
      description: The Life360 circle ID the device belongs to (required if using device_id)
      required: false
      example: "abc123-def456"
      selector:
        text:
    provider:
      name: Provider
      description: Device provider (tile or jiobit) - auto-detected from entity if using entity_id
      required: false
      example: "tile"
      selector:
        select:
          options:
            - "jiobit"
            - "tile"

toggle_light:
  name: Toggle Device Light
  description: Toggle the LED light on a Jiobit device. Useful for visual identification.
  fields:
    device_id:
      name: Device ID
      description: The device ID
      required: true
      example: "abc123"
      selector:
        text:
    circle_id:
      name: Circle ID
      description: The Life360 circle ID the device belongs to
      required: true
      example: "abc123-def456"
      selector:
        text:
    provider:
      name: Provider
      description: Device provider (usually jiobit for light functionality)
      required: false
      default: "jiobit"
      example: "jiobit"
      selector:
        text:
    enable:
      name: Enable
      description: Turn light on (true) or off (false)
      required: false
      default: true
      example: true
      selector:
        boolean:

jiobit_lost_mode:
  name: Jiobit Lost Mode
  description: Activate or deactivate lost/stolen mode for a Jiobit device. When activated, this enhances tracking capabilities and alerts. You can use either entity_id (easier) or device_id + circle_id (advanced).
  fields:
    entity_id:
      name: Entity
      description: The Jiobit device tracker entity (easiest method - automatically determines device_id and circle_id)
      required: false
      example: "device_tracker.jiobit_fluffy"
      selector:
        entity:
          integration: life360
          domain: device_tracker
    device_id:
      name: Device ID (Advanced)
      description: The Jiobit device ID (use this OR entity_id)
      required: false
      example: "dr123456"
      selector:
        text:
    circle_id:
      name: Circle ID (Advanced)
      description: The Life360 circle ID the device belongs to (required if using device_id)
      required: false
      example: "abc123-def456"
      selector:
        text:
    activate:
      name: Activate
      description: Activate (true) or deactivate (false) lost mode
      required: true
      example: true
      selector:
        boolean:
